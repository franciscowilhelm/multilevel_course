{"title":"Kapitel 2: Deskriptive Analysen und Überprüfung von Voraussetzungen","markdown":{"yaml":{"title":"Kapitel 2: Deskriptive Analysen und Überprüfung von Voraussetzungen","format":{"html":{"df-print":"kable"}},"editor":"source"},"headingText":"Pakete laden","containsRefs":false,"markdown":"\n\n\n%todo: Franzpak integrieren %\n\n```{r}\nif (!require(\"pacman\")) install.packages(\"pacman\")\nif (!require(\"franzpak\")) devtools::install_github()\npacman::p_load(haven, psych,\n               sjmisc, sjPlot, writexl, lavaan,\n               tidyverse, multilevelTools, franzpak)\n\n```\n\n## Daten laden\n\n```{r}\nload(\"../data/df_cfa_long.RData\")\n\nhead(df_cfa_long_scores)\n```\nSchauen wir uns nochmal die Datenstruktur unseres aufbereiteten Datensatzes an.\nWir haben die Variablen:\n\n- id: Gruppierungsvariable / Personen-ID, von 1 - 100\n- time: Zeitpunkt / Tag der Messung, von 1-10\n- a, b, c: Rohvariablen\n- a_dm - c_dm: Personen-zentrierte Variablen\n- a_gm - c_gm : Personen-Mittelwerte\n\n## ICC und Within-Person Variance\n\nUns interessiert wie gross der Anteil der Varianz ist, der auf die zwei Ebenen der Daten entfallen (Inner-Person, Zwischen-Person-Ebene). Dies kann uns der ICC angeben. Mittels der Funktion `statsBy()` bekommen wir einige Analysen zu unseren Mehrebenen-Daten geliefert. Die Funktion benötigt zwei Argumente: den Datensatz und und die Gruppierungsvariable.\nWir wählen entsprechend im `select()` die Variablen, die uns interessieren. Dies sind die Gruppierungsvariable \"id\" und die Rohvarianten der Variablen aus, da nur diese die Informationen über beide Ebenen enthalten. Die zerlegten Variablen mit den Kürzeln _dm und _gm brauchen wir erst später.\n\n```{r}\nmehrebenen_stats <- df_cfa_long_scores |> \n  select(id, a, b, c) |> \n    statsBy(group = \"id\")\n```\n\nWir bekommen hier manchmal Warnungen, wenn wir auch  reine Level-2 Variablen eingeschlossen haben. Dies können wir jedoch ignorieren.\nMit `print()` bekommen wir eine Übersicht über die Ergebnisse der Resultate der `statsBy()` Funktion. \n```{r}\nprint(mehrebenen_stats)\n```\n\nUns interessiert nur die Intraclass Correlation (ICC) 1. ICC(2) und Eta-Quadrat interessieren uns nicht.\n\nDen ICC können wir uns auch direkt angeben lassen, indem wir aus dem Listenobjekt `mehrebenen_stats` mit dem Dollarzeichen `$` die Untervariable `ICC1` anwählen.\n\n```{r}\nicc <- mehrebenen_stats$ICC1 |> \n  round(2) # runden\nicc\n```\nAlle Skalen im Beispiel haben ICCs in einem angemessenen Bereich (<.80). Dies heisst, dass genug tägliche Varianz vorhanden ist, um Mehrebenen-Analysen durchzuführen.\n\n## Reliabilitätsanalyse\n\nDie Reliabilitätsanalyse basiert auf den Items, nicht auf den Skalenwerten. Diese haben wir im `df_cfa_long` Dataframe abgespeichert.\n\n```{r}\nhead(df_cfa_long)\n```\n\nBei Skalen aus der Daily Erhebung nehmen wir die `omegaSEM()` Funktion. Als erstes Argument geben wir die Items in einem Character-Vector mittels `c()`, die Items werden mit Anführungszeichen angegeben. Falls ihr die Itemnamen nicht wisst, könnt ihr sie mit `names(df_cfa_long)` nachsehen.\n\n```{r}\nscalea_reliab <- multilevelTools::omegaSEM(c(\"a1\", \"a2\", \"a3\", \"a4\", \"a5\"), \"id\", df_cfa_long)\nscalea_reliab$Results\n```\n\nHier erscheint teils eine Warnung, weil nicht alle Personen (cluster) Varianz auf den Items haben. Dies können wir ignorieren.\nIn den simulierten Daten, die wir verwenden, ist dies jedoch nicht der Fall.\nDann können wir den Output ansehen. Omega_within gibt die Reliabilität für Unterschiede innerhalb der Person an, und Omega_between gibt die Reliabilität für Unterschiede zwischen Personen an. Die Reliabilitäten sollten über .70 liegen für eine gute Reliabilität auf beiden Leveln.\n\n```{r}\nscaleb_reliab <- multilevelTools::omegaSEM(c(\"b1\", \"b2\", \"b3\", \"b4\", \"b5\"), \"id\", df_cfa_long)\nscaleb_reliab$Results\n```\n\n```{r}\nscalec_reliab <- multilevelTools::omegaSEM(c(\"c1\", \"c2\", \"c3\"), \"id\", df_cfa_long)\nscalec_reliab$Results\n```\n\n## Korrelationstabelle\n\nIn psychologischen Artikeln ist (fast) immer die Korrelationstabelle die erste Tabelle des Artikels. Unser nächstes Ziel ist es, die Korrelationstabelle anzufertigen in der wir auch die Mittelwerte und Standardabweichungen integrieren. \n\n\n### Mittelwerte\n\nMittelwerte wurden bereits - pro Person - durch die statsBy() Funktion gebildet. Den allgemeinen Mittelwert bekommen wir  mit der Funktion `summarise()`. Diese erlaubt uns, zusammenfassende Werte zu bilden. Da wir dies gleich für mehrere Variablen machen, benutzen wir zudem `across()` um die Summary gleich für mehrere Variablen zu bilden. Die Funktion benötigt als Argumente (a) die Namen der Variablen mit `c()` als einen Vektor zusammengefasst, (b) die Funktionen, wie sie gebildet werden (hier: `~mean(.x, na.rm = TRUE)` für das arithmetische Mittel unter Ausschluss aller nicht vorhandenen Werte) und (c) optional die Namen der ausgegebenen Variablen mittels \".names\". Wir verwenden \"m_{.col}\". Abschliessend runden wir die Werte.\n\nErsetzt im folgenden Code in der Klammer von `c()` die Variablennamen  mit denen, die euch interessieren, hier sowohl die täglichen als auch Baselinevariablen.\n\n```{r}\nmittelwerte <- mehrebenen_stats$mean |> \n  as_tibble() |> \n  summarise(across(c(a,b,c), ~mean(.x, na.rm = TRUE)))\n\nmittelwerte\n```\nWir sehen, dass a einen höheren Mittelwert (M = 3.03) als b und c (M = 1.94, M = 1.99) aufweist. Für die Verteilung der Variablen sehen wir uns idealerweise auch Histogramme an.\n\n```{r}\nhist(mehrebenen_stats$mean[,\"a\"])\nhist(mehrebenen_stats$mean[,\"b\"])\nhist(mehrebenen_stats$mean[,\"c\"])\n\n```\nAlle Variablen scheinen vom Histogram her hinreichend normalverteilt.\n\n### Standardabweichungen\n\nGanz ähnlich wie mit Mittelwerten verfahren wir für die Standardabweichung, nur dass wir hier als Funktion `~sd(.x, na.rm = TRUE)` verwenden.\nErsetzt auch hier im folgenden Code in der Klammer von `c()` die Variablennamen  mit denen, die euch interessieren, hier sowohl die täglichen als auch Baselinevariablen.\nDie Baselinevariable \"w\" zeigt hier keine SD mit dieser Berechnung und muss separat berechnet werden.\n\n\n\n```{r}\nstandardabweichung <- mehrebenen_stats$sd |> \n  as_tibble() |> \n  summarise(across(c(a, b, c), ~mean(.x, na.rm = TRUE)))\nstandardabweichung\n```\n\n### Korrelationen\n\nWir wollen eine Korrelationstabelle, in der wir auf einen Blick sowohl die Zwischen-Person-Korrelationen als auch die Inner-Person-Korrelationen sehen. Die `statsBy()` Funktion, die wir bereits aufgerufen haben, gibt uns beides separat aus. und \n\n```{r}\nmehrebenen_stats$rbg |> round(2) # Zwischen Person Kor.\n\nmehrebenen_stats$rwg |> round(2) # Inner Person Kor.\n```\n\n\nWir erhalten im unteren Dreieck die Inner-Person-Korrelationen, und im oberen Dreieck die Zwischen-Person-Korrelationen.\n\n\n### Integration in Tabelle\n\nJetzt gilt es, die Mittelwerte, Standardabweichungen, ICCs, und Korrelationen Zwischen und Innerhalb von Personen in einer Tabelle zu integrieren. Mit der `tibble()` Funktion bauen wir einen neue Datensatz-Tabelle, in der wir alle Variablen integrieren.\n\nDie vorhergehenden Analysen zeigen wie man die einzelnen Komponenten der Tabelle erstellt.\nDie Funktion `cortable_multilevel()` führt die einzelnen Funktionen direkt zusammen.\n\n```{r}\ncortable_integriert <- franzpak::cortable_multilevel(df_cfa_long_scores, c(\"a\", \"b\", \"c\"), grp = \"id\")\ncortable_integriert\n```\n\n### Export von Tabellen zu Excel\n\nWir exportieren die Korrelationstabelle nach Excel mittels `write_xlsx()`.\n\n```{r}\n# eval: false\nwrite_xlsx(cortable_integriert, path = \"korrelationstabelle.xlsx\")\n```\n\nDie Excel-Tabelle lässt sich dann in Word kopieren und weiter verarbeitet werden, z.B. mit den richtigen Variablennamen versehen werden etc. Damit haben wir nun die Datenaufbereitung und deskriptive Datenanalyse abgeschlossen.\n\n# Übung:\n\nWendet diese Schritte nun auf den Datensatz aus der letzten Übung an. Zunächst laden wir die Daten, die in der letzten Übung abgespeichert werden sollten.\n\n```{r}\nload(\"../data/df_uebung.RData\")\nhead(df_uebung_lang)\n\n```\n\n```{r}\nhead(df_uebung_lang_scores)\n```\n\n### ICC\n\nBerechnet den ICC für X und Y mittels `statsBy()` und analysiert die Angaben:\n\n- Weisen die Skalen X und Y hinreichend Varianz auf der Inner-Person-Ebene auf, um sie mittels Mehrebenen-Modelle zu analysieren? Begründet eure Antwort.\n\n:::{.callout-tip collapse=\"true\"}\n### Lösung\n\n```{r}\nmehrebenen_stats <- df_uebung_lang_scores |> \n  select(id, x,y) |> \n    statsBy(group = \"id\")\n\nprint(mehrebenen_stats)\n# oder\nmehrebenen_stats$ICC1\n```\n:::\n\n### Reliabilitsätsanalyse\n\nBerechnet die Omega-Within und Omega-Between Reliabilitäten für X und Y mittels `omegaSEM()` und analysiert die Angaben:\n\n- Weisen die Skalen X und Y hinreichende Omega-Werte auf, um Inner-Person Unterschiede reliabel zu messen? Begründet eure Antworten.\n- Weisen die Skalen X und Y hinreichend Omega-Werte auf, um Zwischen-Person Unterschiede reliabel zu messen? Begründet eure Antworten.\n\n:::{.callout-tip collapse=\"true\"}\n### Lösung\n\n\n```{r}\nscalex_reliab <- multilevelTools::omegaSEM(c(\"x1\", \"x2\", \"x3\", \"x4\", \"x5\"), \"id\", df_uebung_lang)\nscalex_reliab$Results\n```\n\n```{r}\nscaley_reliab <- multilevelTools::omegaSEM(c(\"y1\", \"y2\", \"y3\", \"y4\", \"y5\"), \"id\", df_uebung_lang)\nscaley_reliab$Results\n```\n:::\n\n### Integration in Korrelationstabelle\n\nErstellt eine Korrelationstabelle von den Variablen w, x, m, und y mit Mittelwerten, Standardabweichungen, ICC, und Within/Between-Korrelationen wie in Kapitel 1a gezeigt.\n\n:::{.callout-tip collapse=\"true\"}\n### Lösung\n\n```{r}\ncortable_integriert_uebung <- franzpak::cortable_multilevel(df_uebung_lang_scores, c(\"x\", \"y\"), grp = \"id\")\ncortable_integriert_uebung\n```\n:::\n\nBasierend auf euren Analysen zu ICC, Reliabilitsätsanalysen, und der Betrachtung der Korrelationstabelle, beantwortet folgende Fragen:\n\n- Wie fällt die Korrelation zwischen X und Y auf Zwischen-Person Ebene aus? Ist es basierend auf der Prüfungen der Voraussetzungen (ICCs, Reliabilitäten) sinnvoll, diese zu interpretieren?\n- Wie fällt die Korrelation zwischen X und Y auf Inner-Person Ebene aus? Ist es basierend auf der Prüfungen der Voraussetzungen (ICCs, Reliabilitäten) sinnvoll, diese zu interpretieren?\n\n:::{.callout-tip collapse=\"true\"}\n\n#### Zwischen-Person Ebene\nDie Korrelation zwischen X und Y beträgt r = .28 und ist signifikant. Die Reliabilität auf Level-2/ Zwischen-Person Ebene, durch omega_between angegeben, ist für X und Y gut (> .80).\nDie ICCs weisen auf ausreichend Varianz auf Zwischen-Person Ebene hin (53%-69%). Daher ist sie sinnvoll zu interpretieren. DIe Variablen sind moderat positiv miteinander assoziiert.\n\n#### Inner-Person Ebene\nFür Y, auch wenn es durchaus Varianz auf Inner-Person Ebene gibt (ICC = .69, damit sind 31% der Varianz auf Inner-Person Ebene), ist auf Inner-Person Ebene ist die Reliabilität sehr niedrig (Omega-within = .32). Das heisst, dass die  Varianz innerhalb der Personen über die Tage auf Variable Y nicht reliabel gemessen werden. Die Inner-Person Varianz auf Y ist somit nicht sinnvoll zu interpretieren und stellt vermutlich nur \"Rauschen\" dar. Die Korrelation mit X ist nicht sinnvoll zu interpretieren (und fällt auch nicht signifikant aus), auch wenn X sowohl ausreichend Level-1 Varianz hat als auch reliabel gemessen ist.\n\n:::\n\n\n## Zusatz\n\nDie folgenden Analysen sind optional, geben aber ein tieferes Verständnis des Materials.\n\n## Blick hinter die Kulissen: Berechnung von Omega mittels einer Mehrebenen konfirmatorischen Faktorenanalysen\n\n Für eine genauere Auswertung können wir `omegaSEM()` mit dem Parameter `savemodel = TRUE` laufen lassen und uns mittels `summary()` die konfirmatorische Faktoranalyse (CFA) genauer ansehen.\n\nWie CFAs funktionieren, kann hier repetiert werden:\n[Statistik IV - Methodenlehre](https://methodenlehre.github.io/statistik-IV/chapters/CFA.html)\n\nZudem können wir uns mit `lavInspect()` die Modellparameter ansehen, um zu verstehen wie die Reliabilitätskoeffizient gebildet wird.\n\n```{r}\nscalec_reliab <- multilevelTools::omegaSEM(c(\"c1\", \"c2\", \"c3\"), \"id\", df_cfa_long, savemodel = TRUE)\nscalec_reliab$Fit |> summary(fit = TRUE, stand = TRUE)\nlavInspect(scalec_reliab$Fit, \"list\") |> \n  select(lhs, op, rhs, free, level, free, label, est, se) |> \n  mutate(across(where(is.numeric), round, 2)) # alternatively, parTable()\n```\n\nWie der Output zeigt, ergibt sich die Omega-Reliabilität aus dem Anteil der durch den Faktor (f_within für den Faktor auf Level-1 bzw. f_between für den Faktor auf Level-2) erklärten Varianz der Items (Summe aller  Item-Ladungen, quadriert für Varianz) geteilt durch die Gesamtvarianz der Items (durch Faktor erklärte Varianz der Items + Residualvarianz, d.h. übrigbleibende Varianz der Items). Diese Formel wird pro Varianzebene (Level-1, also tägliche Schwankungen innerhalb der Person) und Level-2 (Unterschiede zwischen Personen) getrennt berechnet.\n","srcMarkdownNoYaml":"\n\n## Pakete laden\n\n%todo: Franzpak integrieren %\n\n```{r}\nif (!require(\"pacman\")) install.packages(\"pacman\")\nif (!require(\"franzpak\")) devtools::install_github()\npacman::p_load(haven, psych,\n               sjmisc, sjPlot, writexl, lavaan,\n               tidyverse, multilevelTools, franzpak)\n\n```\n\n## Daten laden\n\n```{r}\nload(\"../data/df_cfa_long.RData\")\n\nhead(df_cfa_long_scores)\n```\nSchauen wir uns nochmal die Datenstruktur unseres aufbereiteten Datensatzes an.\nWir haben die Variablen:\n\n- id: Gruppierungsvariable / Personen-ID, von 1 - 100\n- time: Zeitpunkt / Tag der Messung, von 1-10\n- a, b, c: Rohvariablen\n- a_dm - c_dm: Personen-zentrierte Variablen\n- a_gm - c_gm : Personen-Mittelwerte\n\n## ICC und Within-Person Variance\n\nUns interessiert wie gross der Anteil der Varianz ist, der auf die zwei Ebenen der Daten entfallen (Inner-Person, Zwischen-Person-Ebene). Dies kann uns der ICC angeben. Mittels der Funktion `statsBy()` bekommen wir einige Analysen zu unseren Mehrebenen-Daten geliefert. Die Funktion benötigt zwei Argumente: den Datensatz und und die Gruppierungsvariable.\nWir wählen entsprechend im `select()` die Variablen, die uns interessieren. Dies sind die Gruppierungsvariable \"id\" und die Rohvarianten der Variablen aus, da nur diese die Informationen über beide Ebenen enthalten. Die zerlegten Variablen mit den Kürzeln _dm und _gm brauchen wir erst später.\n\n```{r}\nmehrebenen_stats <- df_cfa_long_scores |> \n  select(id, a, b, c) |> \n    statsBy(group = \"id\")\n```\n\nWir bekommen hier manchmal Warnungen, wenn wir auch  reine Level-2 Variablen eingeschlossen haben. Dies können wir jedoch ignorieren.\nMit `print()` bekommen wir eine Übersicht über die Ergebnisse der Resultate der `statsBy()` Funktion. \n```{r}\nprint(mehrebenen_stats)\n```\n\nUns interessiert nur die Intraclass Correlation (ICC) 1. ICC(2) und Eta-Quadrat interessieren uns nicht.\n\nDen ICC können wir uns auch direkt angeben lassen, indem wir aus dem Listenobjekt `mehrebenen_stats` mit dem Dollarzeichen `$` die Untervariable `ICC1` anwählen.\n\n```{r}\nicc <- mehrebenen_stats$ICC1 |> \n  round(2) # runden\nicc\n```\nAlle Skalen im Beispiel haben ICCs in einem angemessenen Bereich (<.80). Dies heisst, dass genug tägliche Varianz vorhanden ist, um Mehrebenen-Analysen durchzuführen.\n\n## Reliabilitätsanalyse\n\nDie Reliabilitätsanalyse basiert auf den Items, nicht auf den Skalenwerten. Diese haben wir im `df_cfa_long` Dataframe abgespeichert.\n\n```{r}\nhead(df_cfa_long)\n```\n\nBei Skalen aus der Daily Erhebung nehmen wir die `omegaSEM()` Funktion. Als erstes Argument geben wir die Items in einem Character-Vector mittels `c()`, die Items werden mit Anführungszeichen angegeben. Falls ihr die Itemnamen nicht wisst, könnt ihr sie mit `names(df_cfa_long)` nachsehen.\n\n```{r}\nscalea_reliab <- multilevelTools::omegaSEM(c(\"a1\", \"a2\", \"a3\", \"a4\", \"a5\"), \"id\", df_cfa_long)\nscalea_reliab$Results\n```\n\nHier erscheint teils eine Warnung, weil nicht alle Personen (cluster) Varianz auf den Items haben. Dies können wir ignorieren.\nIn den simulierten Daten, die wir verwenden, ist dies jedoch nicht der Fall.\nDann können wir den Output ansehen. Omega_within gibt die Reliabilität für Unterschiede innerhalb der Person an, und Omega_between gibt die Reliabilität für Unterschiede zwischen Personen an. Die Reliabilitäten sollten über .70 liegen für eine gute Reliabilität auf beiden Leveln.\n\n```{r}\nscaleb_reliab <- multilevelTools::omegaSEM(c(\"b1\", \"b2\", \"b3\", \"b4\", \"b5\"), \"id\", df_cfa_long)\nscaleb_reliab$Results\n```\n\n```{r}\nscalec_reliab <- multilevelTools::omegaSEM(c(\"c1\", \"c2\", \"c3\"), \"id\", df_cfa_long)\nscalec_reliab$Results\n```\n\n## Korrelationstabelle\n\nIn psychologischen Artikeln ist (fast) immer die Korrelationstabelle die erste Tabelle des Artikels. Unser nächstes Ziel ist es, die Korrelationstabelle anzufertigen in der wir auch die Mittelwerte und Standardabweichungen integrieren. \n\n\n### Mittelwerte\n\nMittelwerte wurden bereits - pro Person - durch die statsBy() Funktion gebildet. Den allgemeinen Mittelwert bekommen wir  mit der Funktion `summarise()`. Diese erlaubt uns, zusammenfassende Werte zu bilden. Da wir dies gleich für mehrere Variablen machen, benutzen wir zudem `across()` um die Summary gleich für mehrere Variablen zu bilden. Die Funktion benötigt als Argumente (a) die Namen der Variablen mit `c()` als einen Vektor zusammengefasst, (b) die Funktionen, wie sie gebildet werden (hier: `~mean(.x, na.rm = TRUE)` für das arithmetische Mittel unter Ausschluss aller nicht vorhandenen Werte) und (c) optional die Namen der ausgegebenen Variablen mittels \".names\". Wir verwenden \"m_{.col}\". Abschliessend runden wir die Werte.\n\nErsetzt im folgenden Code in der Klammer von `c()` die Variablennamen  mit denen, die euch interessieren, hier sowohl die täglichen als auch Baselinevariablen.\n\n```{r}\nmittelwerte <- mehrebenen_stats$mean |> \n  as_tibble() |> \n  summarise(across(c(a,b,c), ~mean(.x, na.rm = TRUE)))\n\nmittelwerte\n```\nWir sehen, dass a einen höheren Mittelwert (M = 3.03) als b und c (M = 1.94, M = 1.99) aufweist. Für die Verteilung der Variablen sehen wir uns idealerweise auch Histogramme an.\n\n```{r}\nhist(mehrebenen_stats$mean[,\"a\"])\nhist(mehrebenen_stats$mean[,\"b\"])\nhist(mehrebenen_stats$mean[,\"c\"])\n\n```\nAlle Variablen scheinen vom Histogram her hinreichend normalverteilt.\n\n### Standardabweichungen\n\nGanz ähnlich wie mit Mittelwerten verfahren wir für die Standardabweichung, nur dass wir hier als Funktion `~sd(.x, na.rm = TRUE)` verwenden.\nErsetzt auch hier im folgenden Code in der Klammer von `c()` die Variablennamen  mit denen, die euch interessieren, hier sowohl die täglichen als auch Baselinevariablen.\nDie Baselinevariable \"w\" zeigt hier keine SD mit dieser Berechnung und muss separat berechnet werden.\n\n\n\n```{r}\nstandardabweichung <- mehrebenen_stats$sd |> \n  as_tibble() |> \n  summarise(across(c(a, b, c), ~mean(.x, na.rm = TRUE)))\nstandardabweichung\n```\n\n### Korrelationen\n\nWir wollen eine Korrelationstabelle, in der wir auf einen Blick sowohl die Zwischen-Person-Korrelationen als auch die Inner-Person-Korrelationen sehen. Die `statsBy()` Funktion, die wir bereits aufgerufen haben, gibt uns beides separat aus. und \n\n```{r}\nmehrebenen_stats$rbg |> round(2) # Zwischen Person Kor.\n\nmehrebenen_stats$rwg |> round(2) # Inner Person Kor.\n```\n\n\nWir erhalten im unteren Dreieck die Inner-Person-Korrelationen, und im oberen Dreieck die Zwischen-Person-Korrelationen.\n\n\n### Integration in Tabelle\n\nJetzt gilt es, die Mittelwerte, Standardabweichungen, ICCs, und Korrelationen Zwischen und Innerhalb von Personen in einer Tabelle zu integrieren. Mit der `tibble()` Funktion bauen wir einen neue Datensatz-Tabelle, in der wir alle Variablen integrieren.\n\nDie vorhergehenden Analysen zeigen wie man die einzelnen Komponenten der Tabelle erstellt.\nDie Funktion `cortable_multilevel()` führt die einzelnen Funktionen direkt zusammen.\n\n```{r}\ncortable_integriert <- franzpak::cortable_multilevel(df_cfa_long_scores, c(\"a\", \"b\", \"c\"), grp = \"id\")\ncortable_integriert\n```\n\n### Export von Tabellen zu Excel\n\nWir exportieren die Korrelationstabelle nach Excel mittels `write_xlsx()`.\n\n```{r}\n# eval: false\nwrite_xlsx(cortable_integriert, path = \"korrelationstabelle.xlsx\")\n```\n\nDie Excel-Tabelle lässt sich dann in Word kopieren und weiter verarbeitet werden, z.B. mit den richtigen Variablennamen versehen werden etc. Damit haben wir nun die Datenaufbereitung und deskriptive Datenanalyse abgeschlossen.\n\n# Übung:\n\nWendet diese Schritte nun auf den Datensatz aus der letzten Übung an. Zunächst laden wir die Daten, die in der letzten Übung abgespeichert werden sollten.\n\n```{r}\nload(\"../data/df_uebung.RData\")\nhead(df_uebung_lang)\n\n```\n\n```{r}\nhead(df_uebung_lang_scores)\n```\n\n### ICC\n\nBerechnet den ICC für X und Y mittels `statsBy()` und analysiert die Angaben:\n\n- Weisen die Skalen X und Y hinreichend Varianz auf der Inner-Person-Ebene auf, um sie mittels Mehrebenen-Modelle zu analysieren? Begründet eure Antwort.\n\n:::{.callout-tip collapse=\"true\"}\n### Lösung\n\n```{r}\nmehrebenen_stats <- df_uebung_lang_scores |> \n  select(id, x,y) |> \n    statsBy(group = \"id\")\n\nprint(mehrebenen_stats)\n# oder\nmehrebenen_stats$ICC1\n```\n:::\n\n### Reliabilitsätsanalyse\n\nBerechnet die Omega-Within und Omega-Between Reliabilitäten für X und Y mittels `omegaSEM()` und analysiert die Angaben:\n\n- Weisen die Skalen X und Y hinreichende Omega-Werte auf, um Inner-Person Unterschiede reliabel zu messen? Begründet eure Antworten.\n- Weisen die Skalen X und Y hinreichend Omega-Werte auf, um Zwischen-Person Unterschiede reliabel zu messen? Begründet eure Antworten.\n\n:::{.callout-tip collapse=\"true\"}\n### Lösung\n\n\n```{r}\nscalex_reliab <- multilevelTools::omegaSEM(c(\"x1\", \"x2\", \"x3\", \"x4\", \"x5\"), \"id\", df_uebung_lang)\nscalex_reliab$Results\n```\n\n```{r}\nscaley_reliab <- multilevelTools::omegaSEM(c(\"y1\", \"y2\", \"y3\", \"y4\", \"y5\"), \"id\", df_uebung_lang)\nscaley_reliab$Results\n```\n:::\n\n### Integration in Korrelationstabelle\n\nErstellt eine Korrelationstabelle von den Variablen w, x, m, und y mit Mittelwerten, Standardabweichungen, ICC, und Within/Between-Korrelationen wie in Kapitel 1a gezeigt.\n\n:::{.callout-tip collapse=\"true\"}\n### Lösung\n\n```{r}\ncortable_integriert_uebung <- franzpak::cortable_multilevel(df_uebung_lang_scores, c(\"x\", \"y\"), grp = \"id\")\ncortable_integriert_uebung\n```\n:::\n\nBasierend auf euren Analysen zu ICC, Reliabilitsätsanalysen, und der Betrachtung der Korrelationstabelle, beantwortet folgende Fragen:\n\n- Wie fällt die Korrelation zwischen X und Y auf Zwischen-Person Ebene aus? Ist es basierend auf der Prüfungen der Voraussetzungen (ICCs, Reliabilitäten) sinnvoll, diese zu interpretieren?\n- Wie fällt die Korrelation zwischen X und Y auf Inner-Person Ebene aus? Ist es basierend auf der Prüfungen der Voraussetzungen (ICCs, Reliabilitäten) sinnvoll, diese zu interpretieren?\n\n:::{.callout-tip collapse=\"true\"}\n\n#### Zwischen-Person Ebene\nDie Korrelation zwischen X und Y beträgt r = .28 und ist signifikant. Die Reliabilität auf Level-2/ Zwischen-Person Ebene, durch omega_between angegeben, ist für X und Y gut (> .80).\nDie ICCs weisen auf ausreichend Varianz auf Zwischen-Person Ebene hin (53%-69%). Daher ist sie sinnvoll zu interpretieren. DIe Variablen sind moderat positiv miteinander assoziiert.\n\n#### Inner-Person Ebene\nFür Y, auch wenn es durchaus Varianz auf Inner-Person Ebene gibt (ICC = .69, damit sind 31% der Varianz auf Inner-Person Ebene), ist auf Inner-Person Ebene ist die Reliabilität sehr niedrig (Omega-within = .32). Das heisst, dass die  Varianz innerhalb der Personen über die Tage auf Variable Y nicht reliabel gemessen werden. Die Inner-Person Varianz auf Y ist somit nicht sinnvoll zu interpretieren und stellt vermutlich nur \"Rauschen\" dar. Die Korrelation mit X ist nicht sinnvoll zu interpretieren (und fällt auch nicht signifikant aus), auch wenn X sowohl ausreichend Level-1 Varianz hat als auch reliabel gemessen ist.\n\n:::\n\n\n## Zusatz\n\nDie folgenden Analysen sind optional, geben aber ein tieferes Verständnis des Materials.\n\n## Blick hinter die Kulissen: Berechnung von Omega mittels einer Mehrebenen konfirmatorischen Faktorenanalysen\n\n Für eine genauere Auswertung können wir `omegaSEM()` mit dem Parameter `savemodel = TRUE` laufen lassen und uns mittels `summary()` die konfirmatorische Faktoranalyse (CFA) genauer ansehen.\n\nWie CFAs funktionieren, kann hier repetiert werden:\n[Statistik IV - Methodenlehre](https://methodenlehre.github.io/statistik-IV/chapters/CFA.html)\n\nZudem können wir uns mit `lavInspect()` die Modellparameter ansehen, um zu verstehen wie die Reliabilitätskoeffizient gebildet wird.\n\n```{r}\nscalec_reliab <- multilevelTools::omegaSEM(c(\"c1\", \"c2\", \"c3\"), \"id\", df_cfa_long, savemodel = TRUE)\nscalec_reliab$Fit |> summary(fit = TRUE, stand = TRUE)\nlavInspect(scalec_reliab$Fit, \"list\") |> \n  select(lhs, op, rhs, free, level, free, label, est, se) |> \n  mutate(across(where(is.numeric), round, 2)) # alternatively, parTable()\n```\n\nWie der Output zeigt, ergibt sich die Omega-Reliabilität aus dem Anteil der durch den Faktor (f_within für den Faktor auf Level-1 bzw. f_between für den Faktor auf Level-2) erklärten Varianz der Items (Summe aller  Item-Ladungen, quadriert für Varianz) geteilt durch die Gesamtvarianz der Items (durch Faktor erklärte Varianz der Items + Residualvarianz, d.h. übrigbleibende Varianz der Items). Diese Formel wird pro Varianzebene (Level-1, also tägliche Schwankungen innerhalb der Person) und Level-2 (Unterschiede zwischen Personen) getrennt berechnet.\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"kable","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"02 Descriptive Statistics.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.6.40","theme":"cosmo","title":"Kapitel 2: Deskriptive Analysen und Überprüfung von Voraussetzungen","editor":"source"},"extensions":{"book":{"multiFile":true}}},"pdf":{"identifier":{"display-name":"PDF","target-format":"pdf","base-format":"pdf"},"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","output-file":"02 Descriptive Statistics.pdf"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"block-headings":true,"documentclass":"scrreprt","title":"Kapitel 2: Deskriptive Analysen und Überprüfung von Voraussetzungen","editor":"source"},"extensions":{"book":{"selfContainedOutput":true}}}},"projectFormats":["html","pdf"]}